Random-Covariate-Dependent Rectangular Reference Regions Under Multivariate Normality

Raden Gerald R. Agustin

UNIVERSITY OF THE PHILIPPINES DILIMAN

Master of Science in Statistics

June 2022

Abstract

Reference intervals are among the most widely used decision-making tools in the
medical field, and are invaluable in the interpretation of laboratory test results. These
intervals may depend on covariates such as age and sex. The covariate values are often
random quantities since they are typically not controlled in reference interval determina-
tion studies. When several biochemical analytes are needed to diagnose the same condi-
tion, the use of combined univariate reference intervals is not recommendable since the
analytes could be correlated. Instead, a multivariate reference region is necessary to take
the correlations among the analytes into account. Traditionally, multivariate reference
regions have been constructed as ellipsoidal in shape. However, such regions cannot
detect the outlyingness of a specific analyte. We propose procedures to construct rectan-
gular multivariate reference regions that incorporate random covariate information from
the subjects. The reference regions are computed in a multivariate normal setting and
the prediction region criterion is used. A parametric bootstrap approach is employed to
compute the required prediction factor. Numerical results show that the parametric boot-
strap approach is quite accurate, with coverage probabilities very close to the desired
nominal value. Finally, we apply the proposed method to real-life data from a study to
compute covariate-dependent reference regions for insulin-like growth factors.

KEYWORDS: Multivariate reference region; Mixed reference intervals; Parametric bootstrap;
Rectangular prediction region

Chapter 1

Introduction

1.1 Background of the Study

In the field of laboratory medicine, physicians use reference intervals and reference regions to
interpret results of biochemical and physiological tests of patients. In a certain test, a reference
region or interval is obtained based on test results from a healthy population, also called the ref-
erence population. Horn and Pesce (2005) describe reference intervals as ‘‘the most widely used
medical decision-making tool.” These intervals appear in several medical applications, such as the
interpretation of blood tests, clinical urine tests, and so forth. Reference intervals are also used
for tests to diagnose numerous life-threatening conditions such as diabetes, cancer, and even HIV.
Clearly, it is important to have accurate limits in order to avoid misclassification of patients, which
can result in inappropriate health management plans and unnecessary medical costs of such deci-
sions (Odhiambo et al. (2015), Lee et al. (2017)). The theoretical or ideal approach to determine
the reference interval is to find the upper and lower limits that contain the central 95% of the mea-
surements of the healthy population. This however presumes that the entire population is known.

In practice, the reference interval will have to be estimated from the sample.

The concept of reference intervals was developed by Grasbeck (1969) and presented at a

congress of the Scandinavian Society. Without a clear definition of terms, reference intervals were
usually called ‘normal values’ or ‘normal ranges’ until the International Federation of Clinical
Chemistry (IFCC) expert panel published the first official IFCC document on the theory of refer-
ence values (Solberg (1987)). The IFCC’s recommendations, however, were found to be difficult,
time-consuming, and expensive. The guidelines were considered too complicated to be applicable

in practice.

Figure 1.1: Relationships between the terms that are related to references values. This is according to the CLSI (2008) Laboratory Medicine
document C28-A3 and the International Federation of Clinical Chemistry (IFCC).

These difficulties led to a necessary revision of the original recommendation. The present
review is based on the Laboratory Medicine document C28-A3 of the Clinical Laboratory and
Standards Institute (CLSI (2008)) and the MEDLINE search on the theory and production of ref-
erence values in humans and animals. The revised version now allows individual laboratories to
adopt, by transference and verification, reference intervals elsewhere. In addition, the revised ver-
sion includes alternative statistical approaches, such as robust methods that use smaller sample
sizes. A comprehensive treatment of reference regions can be found in the books by Harris and

Boyd (1995) and Albert and Harris (1987).

Since the reference intervals are determined based on the healthy population, individuals may
have to go through examinations of their medical history and a variety of tests such as certain phys-
ical or clinical laboratory tests before taking part in studies that establish reference intervals. The
exclusion criteria that disqualify an individual from being included in the reference sample might
include current illness, recent hospitalization, use of prescription or recreational drugs, obesity,
smoking habit, alcohol intake, raised blood pressure, and so forth. However, some of the exclusion
criteria such as alcohol intake and smoking habit can still be recorded in detail on a questionnaire
and its effects are evaluated statistically using multiple regression analysis (Ozarda et al. (2013),
Ichihara et al. (2013)). The selection of reference individuals using a sample questionnaire is ex-

plained in the document C28-A3.

When constructing reference intervals in laboratory medicine, it is often necessary to account
for variables that can affect the concentration of analytes. These covariates may include sex, age,
body mass index (BMI), environmental factors, and so forth. This study therefore computes ref-
erence intervals that use such information. Moreover, studies that establish reference intervals are
often observational studies (e.g., Patal et al. (2016), Mattsson et al. (2008)). Thus the covariates
are not controlled in the data collection. For this reason, we develop a framework that regards
both the response variables (analytes) and the covariates as random quantities. Finally, we use the
prediction region criterion, the most common criterion used to compute reference intervals and

regions.

The rest of this paper is organized as follows. Chapter 1 proceeds with the motivation and
objectives of this study. Chapter 2 surveys the literature on multivariate reference regions and talks
about the need for rectangular regions. Chapter 3 describes the methodology. Chapter 4 presents

the results, and lastly, Chapter 5 provides a discussion of the study.

1.2 Motivation and Objectives

In applications that involve multiple test profiles, combining univariate intervals results in re-
gions with liberal coverage. To meet the specified coverage requirement, multivariate reference
regions are necessary. One of the applications of multivariate reference regions is the diagnosis of
hepatotoxicity, or drug-induced injury of the liver. Hepatotoxicity is diagnosed based on tests for
markers of the liver enzymes alanine transaminase (ALT) and aspartate transaminase (AST), and
the serum bilirubin. According to Hy’s Law (Zimmerman (1999)), hepatotoxicity is present when
the level of a patient’s ALT is beyond three times the reference limit and his or her bilirubin level
is beyond twice the reference limit. Another application of multivariate reference regions is the

assessment of kidney function through analytes such as urea, uric acid, and creatinine.

The goal of this study is to propose a methodology to compute rectangular reference regions
that incorporate random covariate information from the subjects. The region will be computed
using a prediction region criterion in a multivariate regression framework under normality. The
computation of both two-sided and one-sided reference limits will be examined. In addition, the
study also makes an extension to the case where two-sided limits are required for some components
of the vector of analytes, while only one-sided limits are required for the rest. Such regions will be
referred to as mixed reference regions. In each of these types of regions, the parametric bootstrap

approach is used to compute the required prediction factor.

Chapter 2

Review of Literature

2.1 Univariate Reference Intervals

When measurements are taken on a single analyte, we can define the reference interval as the
interval whose endpoints are the 2.56 and the 97.5" percentiles of the healthy population. If
we only need a one-sided reference limit, we locate either the 95** population percentile for an
upper reference limit, or the 5‘* population percentile for a lower reference limit. An example of a
one-sided reference interval with an upper reference limit is the range for normal values of Fasting
Plasma Glucose (FPG) recommended by the American Diabetes Association (ADA). Table 2.1

shows the reference ranges for the FPG.

Result | FPG

Normal less than 100 mg/dl
Prediabetes | 100 mg/dl to 125 mg/dl
Diabetes 126 mg/dl or higher

Table 2.1: Reference ranges for Fasting Plasma Glucose

Consider the case where two-sided reference limits are required. As mentioned, we take the
2.5" and 97.5" percentiles of the population in order to define the reference interval. However, in

actual practice, these percentiles are unknown parameters. An incorrect approach to address this

problem is to construct the reference interval by taking the 2.5t» and 97.5** sample percentiles.
When such estimated percentiles are used, the proportion of the healthy population covered by
the resulting reference interval will be less than 95%. Thus, as an alternative to this, the most
common approach taken by laboratory professionals in computing reference intervals is to use a
95% prediction interval. More discussion on this can be found in Albert and Harris (1987) and the
document by the National Committee for Clinical Laboratory Standards (2010). Another option,
espoused by authors such as Dong and Mathew (2015) and the recent paper by Liu et al. (2021)
is to compute a 95% tolerance interval. In this paper, we use the prediction region criterion to

compute the reference intervals.

2.2 Multivariate Reference Regions

The multivariate reference region is a straightforward extension of the univariate reference
interval to the multidimensional situation (Albert and Heusghem (1981)). Clearly, the case of
separate univariate reference intervals is not recommendable since the different analytes could be
correlated and the cross-correlations are ignored when computing separate intervals. As noted by
Harris (1981) and Winkel et al. (1976), having separate univariate intervals may lead to an in-
creased risk of false-positive diagnosis. On the other hand, multivariate reference regions take the
correlations among the analytes into account, and are therefore the proper solution in the multi-
dimensional case. In the laboratory medicine literature, multivariate reference regions are either
constructed as ellipsoidal or rectangular reference regions. We now compare these two types of

regions.

2.2.1 Ellipsoidal Multivariate Reference Regions

Traditionally, multivariate reference regions have been constructed as ellipsoidal in shape since
exact solutions to compute such regions are available for the multivariate normal distribution,

which is a common data assumption used in the reference interval literature. In practice, the most

frequently used approach in constructing joint reference regions for clinical laboratory values is
the work of Boyd and Lacher (1982). They propose to compute the multivariate reference region
by means of concentration ellipsoids of the multivariate normal distribution based on Mahalanobis
distances between single observations and the vector of means. Specifically, if X,,...,Xn isa
random sample from the p-variate normal distribution with mean yz and covariance matrix ©, and
if X and S are the sample mean and sample covariance matrix, respectively, then Boyd and Lacher

(1982) compute the 100(1 — a)% reference region as

{X : (X — X)'S1(X — X) <x3_.)}

where x?_,(p) is the (1 — a)-quantile of a chi-square distribution with p degrees of freedom. Their
methodology computes the reference region as a prediction region. The chi-square percentile gives
exact coverage if jz and © were known and were used instead of X and S. The exact distribution

when the sample versions are used is the Hotelling’s T? distribution.
Dong and Mathew (2015) also introduce an ellipsoidal reference region computed through
a central tolerance region criterion under multivariate normality. To describe their solution, let

y € (0, 1) and consider the central 100% part of the N, (4, ©) distribution

R= {X:(X—p)E"(X —p) < 20)}.

The ellipsoidal central tolerance region given by

where k is determined such that the following equation is satisfied:

P(RCQ)=1-a.

That is, the reference region should contain the central 100-y% part of the population with proba-
bility 1 — a. The quantity + is called the content of the tolerance region. Dong and Mathew (2015)

propose an algorithm to compute k.

Ellipsoidal multivariate reference regions, however, have one major disadvantage: they cannot
detect the outlyingness of a specific analyte. Thus, patients who are identified as ‘non-healthy’
based on an ellipsoidal reference region do not have information on which specific analyte has
caused them to be tagged as such. This lack of interpretability of ellipsoidal regions, coupled with
the fact that most multivariate reference regions are ellipsoidal, has caused laboratory practitioners
to be reluctant to use multivariate reference regions (see Wellek (2011)). Moreover, Albert and
Harris (1987) and Strike (2014) also mention another deficiency of ellipsoidal reference regions:
they tend to produce false negative results in the presence of only one or two extreme components.

For these reasons, this study computes reference regions of rectangular shape.

2.2.2 Rectangular Multivariate Reference Regions

What can be considered the first successful attempt to construct a rectangular multivariate refer-
ence region in both the multivariate normal and nonparametric setups is the work of Wellek (2011).
However, Wellek only gives a point estimate of the rectangular reference region and their solution
uses neither a prediction region nor a tolerance region criterion. The recent study by Young and
Mathew (2020) develops nonparametric two-sided rectangular prediction regions that rely on the
general notion of data depth. While the reference regions in their study achieve accurate coverage,
the sample sizes required to meet the nominal coverage level can be too large as to be excessively
costly. For instance, a minimum sample size of 300 is necessary to attain the nominal confidence
level in the bivariate and trivariate settings they considered. In certain distributional settings, sam-

ple sizes as large as 1000 are necessary.

2.2.3 Justification for the Use of Random Covariates

The studies of Young and Mathew (2020) and Lucagbo et al. (2021) propose solutions to incor-
porate covariate information in the computation of reference regions. Their solutions assume that
the covariate values are fixed. In actual practice, however, the fixed-covariate assumption is not al-
ways satisfied. Some data collection schemes may involve covariates which are random in nature.
We now explain situations in which each of the two assumptions on the nature of the covariates is

appropriate.

The assumption of fixed covariates is appropriate in experimental studies where the factors are
fixed at certain levels and measurements on the response variable are taken from the experimental
subjects. The fixed covariates assumption is also appropriate in studies where subjects are first
grouped based on their characteristics (e.g., their sex or age), and a sample of subjects is taken for
each level of the characteristic of interest. In general, the assumption of fixed covariates is tenable
when the experimenter or researcher can control the values of the explanatory variables. Multiple
observations on the response variable can then be obtained, corresponding to the fixed values of
the covariates. On the other hand, the random covariates assumption is appropriate in uncontrolled
environments such as observational studies and many examples of survey research where proba-
bility samples are used. Under such settings, the response variable is often under the influence of
explanatory variables which vary together with the response and are therefore stochastic in nature
(Bharali and Hazarika (2018)). It makes more sense to model the covariates as random variables

whose sample values are determined from random draws from the population.

Reference interval determination studies are often observational studies that recruit subjects
without controlling the covariate values. Examples of such studies are Mattsson et al. (2008) and
local studies like that of Patal et al. (2016). In the case of Mattsson et al. (2008), blood sample
measurements were drawn from 427 healthy German blood donors, without controlling for the

explanatory variables considered in their study: sex, age, and BMI. The study by Patal et al.


(2016) recruited 616 healthy pregnant women without controlling for or stratifying by the main
covariate of interest: semester of pregnancy. More examples can be found in the studies described
in Harris and Boyd (1995) and Albert and Harris (1987), both of which give a detailed treatment
of multivariate reference regions. Due to the uncontrolled nature of the covariates in the studies
mentioned, the covariate measurements ought to be regarded as realizations of random variables.
For this reason, the present study tackles the problem of computing multivariate reference regions

in a regression setting with random covariates.

2.2.4 When to Use Random vs Fixed Covariates

As mentioned earlier, the assumption of fixed covariates holds when we take response mea-
surements for a fixed level of the explanatory variable. For instance, if we stratify the population
by sex, and take a sample of healthy men as well as a sample of healthy women, and compute
reference intervals for each of the two subpopulations, then the fixed methodology is appropriate.
In studies where the goal is to compute age-specific reference intervals, the subjects may also be
grouped by specific ages or age ranges and a sample of subjects from each group may be taken.
Such a scheme will ensure the appropriateness of treating the covariate age as fixed. On the other
hand, random covariates should be used in the studies such as that of Mattsson et al. (2008) where
it is of interest to compute reference intervals for various covariate values, yet in the data collection
the values of the response and covariates vary together. That is, we do not group patients by age
or sex or BMI and take samples from each group. Rather, all donors satisfying certain inclusion
criteria are recruited without any such blocking or stratification. This makes the response and co-
variates both random quantities. Each response-covariate pair of measurements should be regarded
as a sample from a joint distribution and the correct approach is to make inferences from this joint

distribution.


Chapter 3

Methodology

We shall now explain our proposed methodology to compute the rectangular reference regions.
We start by writing the multivariate regression model with random covariates. Let Y,,...,Y, be
response vectors representing the laboratory measurements taken from each subject, where each
Y; is of dimension p x 1, and let X,,...,X, be the corresponding g x 1 covariate vectors. We

assume that Y; and X; are related through the following model:
Y,;=68)+O,Xit+e, t=1,...,n, (3.1)

where (, is an unknown p x 1 intercept vector, G, is an unknown p x q matrix of coefficients, and
e;, 7 = 1,...,n are iid p x 1 error terms. The distributional assumption on the random quantities

X; and e; is given by

~ Natp ’ » t=1,...,n, (3.2)

where 2, is an unknown q x 1 parameter vector, and 2. and & are unknown positive definite

matrices of dimension q x q and p x p respectively. From (3.2) we can derive the following


moments of X ; and Y; as

E(X;) = w, (3.3)
E(Y;) = E(By + 1X; +e:)
= 9+ By, (3.4)
Var(¥;) = Var(By + BX; +e)
= B26, +E (3.5)

Cov(X;, Yi) = Cov( Xi, By + BX: + e:)

= 06). (3.6)
Consequently, the observed data (X‘, Y‘)’, i = 1,...,n are iid with the following multivariate
normal distribution:
Xx; be a 28;
~ No+p , : . (3.7)
Y; Bot Bibs B,Q B,26,+%

From (3.7) it can be shown directly that the conditional distribution of each Y; given X; is

Y;|Xi~N,(8)+0,Xi,E), i=1,...,n. (3.8)

1 1 1
Write Y = [Yi,Yo,...,. Yn], X = , and B = [8 (,], so that Y and X
X, X, .. X,

are p x n and (q + 1) x n matrices, respectively, and B is a p x (q + 1) matrix. To estimate the


unknown quantities 4,, B, 2, and X, we use the least squares estimators given by

B=YX'(xXx')? (3.9)
= [Bo G1]

. 1 n _ =,

X= —— dx ~ K)(X;- X) (3.10)

y= lh — X"(XX') | XY’, (3.11)

where I,, represents the n x n identity matrix.

3.1 Two-Sided Prediction Regions

In this section, we describe the methodology to compute two-sided reference regions. Suppose
that, corresponding to a (q x 1) covariate vector Xo we want to compute a reference region for
a (p x 1) response vector of analytes Y through a rectangular prediction region criterion. We
assume that (Xo, Yo)’ is independent of the observed data and also follows the model in (3.1).

That is,
Yo = By + Bi Xo + &o,

where € is a p x 1 vector of error terms and (Xo, 9)! follows the distribution in (3.2). Let the
elements in Yo = (yo1,---, Yop)’. Thus, we want to find the values (a);,@2;), 7 = 1,...,p such

that all of the following p statements:

a1 S yor S @21

Qy2 S yoo S< A22

Qip S Yop S 2p


are jointly satisfied with probability 0.95. Throughout this manuscript, we use the notation V(;) to
represent the ith element of a vector V and M_;,,) to represent the ith diagonal element of a matrix

M. We specify the required rectangular reference region (a11, @2i] x ... x [@ip, @2p] to be of the

G + B,Xo)u) + ko Ean] Kr XK G + B,Xo)q) + ko/ En (3.12)

where kz is the unknown prediction factor. The subscript of kp is meant for the fact that it is a

form

prediction factor of a two-sided reference region. Observe that

P (vs E (Bo + A, Xo)y thoy Bay Vi=1, ob) =l-a (3.13)

(yo: — (Bp + 8, Xo) 4)
V bate)
<> P| max Yor — (By + B,Xo)i)

1si<p Se

Equation (3.14) gives a basis for a parametric bootstrap procedure to estimate the true value of kp.

— P

<kp W=1,...p] =l-a

<k,}| =1-a. (3.14)

Algorithm 1 describes this and the computation of a two-sided rectangular prediction region in the
presence of covariates. Note that in selecting the bootstrap samples, the algorithm makes use of

the result for the joint distribution of X; and Y; in (3.7).


Algorithm 1 Rectangular prediction region for a multivariate normal distribution in a regression
setting.

1. Let ¥ = [¥1, Yo, .... Yq] be the p x n data matrix and X = lx, xy ; x,
the (¢ + 1) x n matrix of covariates. Suppose two-sided prediction limits are required
for a response vector Y 9 corresponding to the vector of covariates X 9.

2. Compute the estimates of ,, B,Q, and ¥ as fp, = X, and B, 2, and 3 using (3.9),
(3.10), and (3.11), respectively.

3. Forb = 1,...,B:

i. Generate the bootstrap observations
Q NB;

[ye] ~ F By | ra . ee .
ii. Compute the bootstrap statistics j2;, B;, a, 3s, through the same formulas as j2,,
B, Q, and ¥ but using the bootstrap observations fori = 1,...,n (i.e., excluding
i=0).
iii. Compute

be

Jase = 08).

max

Y boca) (Boot Bie XSu)ca | kt
I<igp Bru) »

where Bow and Bi are obtained from B, = [Bee Bi .

4. Estimate ky by ka, obtained by getting the (1 — a)-sample quantile of kf, ..., ki.
5. The 100(1 — a)% rectangular prediction region of Y is given by

(By + By Xo) + koy/ Lu, i=1,...,p

where Sua is the i‘* diagonal element of x.


3.2 One-Sided Prediction Regions

In many cases, we only need one-sided reference regions instead of two-sided ones. That is,
the reference region either consists only of upper limits or only of lower limits for the individual
components. This happens when, for instance, the values of the analytes should not exceed a
specified threshold (i.e., the measurements should not be too high) but low values of the analyte
are usually not a concern. We can easily modify Algorithm 1 to compute the one-sided prediction
regions to be used as reference regions having either upper limits only or lower limits only. To

compute the upper one-sided reference region, we modify Step 3(iii) of the Algorithm 1 as

kt = max Yoo.) ~ (Bo0+ Bie X do) (0)
b ¢ =e o
1<i<p V2bui)

Let k,_, be the (1 — a)-quantile of k*, ..., kj as defined above. Then the resulting (1 — a)-upper

one-sided reference region is given by

(= (Bo + B,Xo)ay + kya Ea] KX (-s (Bo + B,Xo)ip) + kyo V Emm):

Similarly, for the lower limits, we use

Y boi) —(Bo0+ Pie XG5)(0)

kg = min =
Loi)

1<i<p

and take k, as the a-quantile of k7,..., kj. Then the resulting (1 — a)-lower one-sided reference

region is given by

(Bp + By Xo)ay + ka Eav,00) XX G + B,Xo)ip) + kar! Depp 00).

Algorithm 2 describes the procedure for both upper and lower one-sided prediction regions.


Algorithm 2 One-sided rectangular prediction region for a multivariate normal distribution in a
regression setting.

1. Let ¥ = (¥1,¥9,..., Yq] be the p x n data matrix and X = lx, x, - x, be
the (q+ 1) x n matrix of covariates. Suppose two-sided prediction limits are required
for a response vector Y 9 corresponding to the vector of covariates X 9.

2. Compute the estimates of w,, B,Q, and X as pf, = X, and B, 9, and 3 using (3.9),
(3.10), and (3.11), respectively.

3. Forb=1,...,B:

i. Generate the bootstrap observations

Ea ~ Nesp be | fe} 26;
* SpA AP ~
Yip Bo + Biz]? |B,Q BB, +B
ii. Compute the bootstrap statistics f5, B,, 9, 4, through the same formulas as jz,,
B, {2, and & but using the bootstrap observations for i = 1,...,n (i.e., excluding
i=0).
iii, Compute for the prediction factor:
a. For upper one-sided reference region, we have
Pre Y bx) ~ Boot B16-X bs) ca)
1<i<p Vt
b. For lower one-sided reference region, we have
«Yoo ~ (Boot Bie X bu)
ke =m ots)
‘blower we VEiun
where Bow and Bi are obtained from B; — [Boe Bi] .

4. a. If an upper one-sided reference region is needed, compute kia by getting the
(1 — a)-sample quantile of ky. oper) ++) KB upper
b. If a lower one-sided reference region is needed, compute ka by getting the
a-sample quantile of Kt jouer: «+» KB tower"
5. The 100(1 — a)% rectangular prediction limits of Yo are given by

a. (-= (Bo + 8, Xo) +h «(Be ,i = 1,...,p, for an upper one-sided

reference region

Jatt 0,

L* =
Kb upper

b. G + Bi Xo)a + ka dua, co) ,i = 1,...,p, for a lower one-sided reference

region where Dun is the 7*" diagonal elements of s.


3.3. Mixed Prediction Regions

In some applications of the multivariate analysis of laboratory test results, two-sided reference
limits are required for a subset of the analytes while only one-sided limits are needed for the rest.
This leads to a reference region with two-sided limits for some univariate components and one-
sided limits for the rest. This study refers to such regions as mixed reference regions. As with the
other types of regions, we obtain the mixed reference regions through a prediction region crite-
rion. Thus, the region of interest is a mixed prediction region (i.e., it consists of a combination of
two-sided and one-sided intervals). An example of an application that calls for the development of
such regions is the diagnosis of kidney function, for which the laboratory medicine literature uses
reference limits for urea, uric acid, and creatinine. Two-sided reference limits are necessary for
uric acid and creatinine, while only an upper reference limit is needed for urea since, as Cleveland

Clinic (2020) argues, “Low urea levels are not common and rarely a cause for concern.”

To explain the methodology to construct a mixed prediction region, we first consider a bivariate
situation. Suppose we want a prediction region for Yo = (Yyo1, Yoo)’ with corresponding covariate
vector Xo. Without loss of generality, assume that the first component requires two-sided limits

and the second component only requires an upper reference limit. Thus the region is of the form
a + B,Xo)ay + km Ean] x (-= (Bo + B,Xo) (2) + kay) S|
where k,,; and k,,2 are chosen so that
P (uo € (By +B; Xo) ry  kmry/ Da), Yor S (Bo + By Xo)2) + km2 Ean) =l-a.

This is equivalent to

yor — (By + BX)

Yor — (Bo + Pr Xo)aay < kimi McK |=l—a. (3.15)

Za V Zo)

P

There are infinitely many possible values of km and km that could satisfy the equation in


(3.15). Thus, kn, and kj,2 are not unique, and it is necessary to impose a constraint on the two
quantities in order to get a unique solution. In computing mixed prediction regions which are not
covariate-dependent, Lucagbo et al. (2021) impose an equal marginal coverage constraint. The
equivalent constraint in terms of the present problem would be to find k,,, and kyn2 such that the

two marginal events in inside the parentheses in (3.15) have the same probability. That is, the

yor — (Bo + B,Xo)ay

VEan

desired constraint is to choose k,,; and k,,2 such that
— (By + BX
< kn _p| @ (By + BX 0) (2) < ko | . (3.16)

However, it may not be possible to find an exact solution to this because the distributions of the

quantities
yoi — (By + By Xo)5)

j = 1,2 are unknown. Thus, we instead impose an “approximately equal” marginal coverage

(3.17)

constraint which we develop as follows. Suppose we write (3.16) in terms of the true parameter
values J, 3,, and B instead of their estimates. Since Yo|Xo ~ Np(B9 + B,Xo, E), it follows
that

z, = Y= (By + P1 Xo)
’ VX)

are identically distributed as \V(0, 1). Thus, rather than impose the condition in (3.16), we impose

=1,2 (3.18)

the constraint obtained by using the true values of the parameters instead of their estimates:

P(\Z1| < kin) = P (Zo < kma)-

This now allows us to express the prediction factors as functions of each other. Let &(-) de-

note the CDF of the standard normal distribution. The approximately equal marginal coverage


constraint can be expressed as

2®(kin1) — 1 = O(km2)

king = ®71(2®(kym1) — 1). (3.19)

Substituting the expression for k,,2 in (3.19) into the second inequality inside the probability in

(3.15), we get the following expression for the inequality:

Yoo — (By + 8, Xo) (2)
V E22)

1 ; +6 yor — (By +B: Xo)i2)

Now replacing the second inequality in (3.15) by (3.20), we arrive at
yor — (By + By Xo)qy

P [=| : oo f ( +o (ieee = Aez2%90) < ta] = 1-a.
y Zan X22)
@.21)

The equation in (3.21) gives us a way to estimate k,,; via a parametric bootstrap. After obtaining

< O'(26(kmi) — 1)

=> & < km. (3.20)

an estimate for k,»1, the constraint in (3.19) gives us an estimate of kno.

The procedure just described is for the bivariate case, but we can easily extend this idea to
the case where we have more that one two-sided interval, or more than one one-sided interval, or
both. Without loss of generality, suppose that the first p; of the intervals are to be two-sided and
the remaining p — p, of them are to be upper-sided. In consonance with the approximately equal
marginal coverage condition, we use the same prediction factor k,,; for all two-sided intervals and
the same prediction factor k2 for all one-sided intervals. We still take k,,; and km to be related
as in (3.19). The extension of (3.21) to the case where there could be more than one two-sided

interval, or more than one one-sided interval, or both is given by


P (max {a,b} < km) =1—-a. (3.22)

where

yoi — (By + Bi Xo) 4)

<i<pi Diy
1 i — (Bo + By Xo) ci
b= max 67} 1+ Yor To Pit ol (Bo + Ai Xo)e

Pitl<i<p 2 [Sxis)

The expression in (3.22) gives us a basis for the parametric bootstrap to estimate k,,, in the multi-
variate case. Algorithm 3 provides the steps necessary to estimate k,,; by the parametric bootstrap.
Take note that in the case where lower limits are required, we simply express them as upper limits

by a change of sign.


Algorithm 3 Mixed rectangular prediction regions for a multivariate normal distribution in a re-
gression setting.

1 1 1
X, Xo .. Xa
the (q¢ + 1) x n matrix of covariates. Suppose two-sided prediction limits are required

for the first p) < p components of a response vector Y 9 corresponding to the vector
of covariates X 0, and upper-sided prediction limits are required for the remaining p — p;
components.
2. Compute the estimates of z,, B,, and % as fz, = X, and B, 9, and © using (3.9),
(3.10), and (3.11), respectively.
3. Forb=1,...,B:
i. Goes the bootstrap observations
2 26;

ib Bo + Bifte]’ | A,0 A108; +z
ii. Compute the bootstrap statistics By, B;, 2, ys, through the same formulas as j2,,
B, Q, and & but using the bootstrap observations for i = 1,...,n (ie., excluding
i=0).
iil, Compute

1. Let Y = (Yi, Yo, ..., Y,] be the p x n data matrix and X = be

ee

Yiow ~ (Boo + BisXin)

a= max

1<i<pi x.
Yow) — (os + By X. is) 6

b= max o?]- [146 | ———-~—___*@ ;
pi tl<i<p 2 a*
V =a

ke max(a, 6)

‘miz,b

4. Compute the kmi by getting the (1 — a) sample quantile of k*,;.1,..-,kyiig,p and compute

km = ®-1(20(km1) — 1))
5. The (1 — w)100% rectangular mixed prediction region is given by

G + BXo)ay + kmiy Zan sx a Bo + By Xo)ip,) + km y/ En x
(-= (Bo + By Xo) (141) + kno Eonsintn| XX (-20 (Bp + B,Xo)~p) + kmar/ Eon ;


Chapter 4

Results

4.1 Simulation Settings

To evaluate the accuracies of the proposed prediction regions, we shall estimate their asso-

ciated coverage probabilities. We generate the data from a multivariate normal distribution with

My ; _ | 2 26; ;
mean and covariance matrix using the R package MASS

Bot Bibs BQ B,28,+E
by Ripley et al. (2013). The sample sizes used are n = 30, 50, 100, and 120. The results are based

on M = 5000 simulations, where each simulation used B = 500 bootstrap samples. The nominal

confidence level used is 1 — a = 0.95.

The following are the parameter settings used in our simulation study:


Bo B, Hz x 2
Z 21 T 08 205
=2q=2 (1,2) ' (
pend (1,2) (; a} (2,3) (cs 1 0.5 )
2 05 08
p=2q=3 © (4,2) CG ; >) (2,3,4)! (cs 8 05 1 05
05 05 1
1 05 05 05
2214 1 05 05 1 05 05
=2q=4 (2,2) '
a (2,2) G 2 4 1) | &41,2) (os 1 0.5 0.5 2 05
05 05 05 2
1 05 05
p=3,qg=2  (2,2,3)' G ; 3) (3,2)! 05 1 05 (cs ”)
05 05 é 2
113 1 05 05 2 05 0.5
p=3,q=3 (2,3,1" | [2 3 2 (3,2,2) 05 1 05 05 2 05
142 05 05 05 05 1
2113 1 05 05 os foe oe
p=3,q=4 (3,2,2” | {3 21 1) | @3,2,4'| [os 1 05 3 0.
arr Oe os 05 05 2 05
5 0. 05 05 05 1
422 1 05 05 0.
134 05 1 08 05 205 05
p=4,q=3 (3,1,2,1)' (4,3,1y | |? 5 0. 05 1 05
412 05 05 1 05 ce os Tt
223 05 05 05 1 50.
1223 1 05 05 05 2 05 05 0.5
a /{{1 3 42 ,|{o5 1 05 o5}] fos 1 05 05
P=4q=4 (2312) 1 14 7 1 3] ] 340") los o5 1 05} | ]o5 05 1 05
2234 05 05 05 1 05 05 05 2
TL

4.2 Numerical Results for Two-sided Prediction Regions

Table 4.1 shows the coverage probabilities for the two-sided prediction region under different

settings. Based on the results shown in the table, we see that the coverage probabilities are close

to the nominal value of 0.95 even when the sample size is small. Therefore, the procedure shows

satisfactory performance that is robust to the sample size. Moreover, we still get the desired nomi-

nal value when we try to increase the dimensions p and q.

The performance of the proposed rectangular reference region should also be assessed by its

expected volume, which is the multivariate counterpart of a confidence or prediction interval’s


coverage probability

n = 30 | n= 50 | n= 100 | n= 120
p=2,q=2 0.9536 | 0.9490 | 0.9482 | 0.9538

p=2,q=3 0.9506 | 0.9406 | 0.9500 | 0.9456
p=2,q=4 0.9508 | 0.9486 | 0.9502 | 0.9464
p=3,q=2 0.9454 | 0.9430 | 0.9472 | 0.9492
p=3,qg=3 0.9501 | 0.9472 | 0.9472 | 0.9492
p=3,q=4 0.9448 | 0.9458 | 0.9444 | 0.9478
p=4,q=3 0.9440 | 0.9482 | 0.9458 | 0.9498
p=4,q=4 0.9448 | 0.9504 | 0.9524 | 0.9490

Table 4.1: Estimated coverage probabilities of the parametric bootstrap two-sided prediction regions under multivariate normality for a 95% nominal
level.

expected length. The region’s volume is computed using the formula

volume = (2 x ko)? x D5

where Ds, is the product of the diagonal elements of ¥. In Table 4.2, we can see the mean vol-
umes under each of the scenarios. As expected, when the dimensions p and q increase, the mean

volume also increases. On the other hand, as the sample size increases, the mean volume decreases.
In Table 4.3, we can see the expected values of the prediction factor ko. Notice that when the

dimensions p and q increase, the expected value of ko also increases. Moreover, the expected value

of ka decreases when the sample size increases, as one might suspect.


mean volume

n=30 | n=50 | n=100 |] n=120
p=2,q=2 23.8545 | 21.8533 | 20.6368 | 20.3994

p=2,qg=3 24.9617 | 22.3519 | 20.9206 | 20.5785
p=2,q=4 26.0852 | 22.9311 | 21.0792 | 20.7518
p=3,q=2 143.4456 | 124.3515 | 113.4256 | 111.1571
p=3,q=3 154.0381 | 128.7691 | 115.0441 | 112.8093
p=3,q=4 165.2101 | 133.5351 | 116.5513 | 114.2389
p=4,qg=3 985.0451 | 772.1909 | 656.2602 | 638.9143
p=4,q=4 1084.096 | 814.4054 668.4637 | 650.7543

Table 4.2: Expected values of the volume of the parametric bootstrap two-sided prediction regions under multivariate normality for a 95% nominal
level.

E(k)

n= 30 |n=50] n= 100} n=120
p=2,q=2 2.4599 | 2.3471 | 2.2715 | 2.2631
p=2,qg=3 2.5171 | 2.3762 | 2.2867 | 2.2714
p=2,q=4 2.5721 | 2.4031 | 2.2977 | 2.2805
p=3,q=2 2.6298 | 2.5035 | 2.4183 | 2.4059
p=3,q=3 2.6894 | 2.5307 | 2.4320 | 2.4165
p=3,qg=4 2.7546 | 2.5641 | 2.4455 | 2.4277
p=4,qg=3 2.8099 | 2.6393 | 2.5312 | 2.5130
p=4,q=4 2.8778 | 2.6739 | 2.5430 | 2.5242

Table 4.3: Expected values of the parametric bootstrap two-sided prediction region factor (2) under multivariate normality for a 95% nominal
level.

4.3 Numerical Results for One-sided Prediction Regions

4.3.1 Upper One-Sided

Table 4.4 shows the coverage probabilities for the upper one-sided prediction region under
different settings. Based on the results shown in the table, we see that the coverage probabilities are
close to the desired nominal value of 0.95, even with a small sample size and increasing dimensions
of p and q. Thus, the proposed procedure shows satisfactory performance that is robust to the

sample size and different dimensions of p and q.


coverage probability

n = 30 | n=50 | n= 100 | n= 120
p=2,q=2 0.9510 | 0.9474 | 0.9472 | 0.9474
p=2,qg=3 0.9500 | 0.9482 | 0.9472 | 0.9462
p=2,q=4 0.9458 | 0.9438 | 0.9432 | 0.9456
p=3,q=2 0.9484 | 0.9544 | 0.9502 | 0.9484
p=3,q¢=3 0.9424 | 0.9456 | 0.9448 | 0.9466
p=3,q=4 0.9488 | 0.9484 | 0.9432 | 0.9442
p=4,q=3 0.9462 | 0.9516 | 0.9478 | 0.9418
p=4,q=4 0.9478 | 0.9474 | 0.9464 | 0.9524

_

Table 4.4: Estimated coverage probabilities of the parametric bootstrap upper one-sided prediction regions under multivariate normality for a 95%
nominal level.

Table 4.5 displays the expected values of the prediction factor ky _ upper. AS expected, when the
dimensions p and q increase, the expected value of k,_upper also increases, while when the sample

sizes increases, the expected value of kj _ upper decreases.

E(k upper)
n = 30 | n=50 | n= 100 | n = 120
p=2,qg=2 21011 | 2.0186 | 1.9588 | 1.9484
p=2,q=3 2.1442 | 2.0427] 1.9702 | 1.9600
p=2,q=4 2.1944 | 2.0635 | 1.9823 1.9662

p=3,q=2 2.2773 | 2.1787 | 2.1123 | 2.1026
p=3,q=3 2.3275 | 2.2036 | 2.1240 | 2.1125
p=3,q=4 2.3797 | 2.2326 | 2.1380 | 2.1204

p=4,q=3 2.4471 | 2.3176 | 2.2279 | 2.2150
p=4,q¢=4 2.5049 | 2.3406 | 2.2395 | 2.2266

Table 4.5: Expected values of the parametric bootstrap two-sided prediction region factor (ki — upper) under multivariate normality for a 95%
nominal level.


4.3.2 Lower One-Sided

Similar findings are obtained if we compute lower one-sided prediction regions using the pro-
posed procedure. Tables 4.6 and 4.7 display the coverage probabilities and the expected values
of the prediction factor ket —lowers respectively. The coverage probabilities for the lower one-sided
prediction region are fairly close to 0.95, even with a small sample size. In addition, even when the

dimensions p and q are increased, the coverage probabilities remain close to the desired nominal

value of 0.95.

The prediction factor ka—tower has a negative value since it is computed as the 0.05th quantile
of a distribution that includes negative values. When the sample size increases, the expected value
of ki tower decreases in absolute value. In addition, the expected value of ki lower increases in
absolute value when the dimensions p and q increase. Moreover, notice that the expected values of
key tower are almost the same (within Monte Carlo error) as the negative of the expected values of

ky -upper- This is expected since we are computing prediction regions for a symmetric distribution.


coverage probability

n = 30 | n=50| n= 100] n=120
p=2,q=2 0.9478 | 0.9460 | 0.9478 | 0.9546
p=2,q=3 0.9502 | 0.9496 | 0.9450 | 0.9440
p=2,q=4 0.9514 | 0.9462 | 0.9414 | 0.9508
p=3,q=2 0.9478 | 0.9446 | 0.9466 | 0.9454
p=3,q¢=3 0.9440 | 0.9480 | 0.9480 | 0.9500
p=3,q=4 0.9490 | 0.9454 | 0.9502 | 0.9508
p=4,q=3 0.9512 | 0.9454 | 0.9532 | 0.9460
p=4,q=4 0.9506 | 0.9452 | 0.9458 | 0.9436

Table 4.6: Estimated coverage probabilities of the parametric bootstrap lower one-sided prediction regions under multivariate normality for a 95%
nominal level.

E(ky—tower)

n = 30 | n=50 | n= 100 | n= 120
p=2,q=2 -2.1019 | -2.0167 | -1.9599 | -1.9510
p=2,q=3 -2.1466 | -2.0404 | -1.9700 | -1.9577
p=2,q=4 -2.1973 | -2.0645 | -1.9814 | -1.9688
p=3,q=2 -2.2747 | -2.1760 | -2.1121 | -2.1015
p=3,q=3 -2.3244 | -2.2049 | -2.1243 | -2.1107
p=3,q= -2.3784 | -2.2298 | -2.1364 | -2.1217
p=4,q=3 -2.4473 | -2.3144 | -2.2300 | -2.2157
p=4,q=4 -2.5039 | -2.3426 | -2.2399 | -2.2269

Table 4.7: Expected values of the parametric bootstrap two-sided prediction region factor (ki ~tower) under multivariate normality for a 95%
nominal level.


4.4 Numerical Results for Mixed Prediction Regions

For the mixed prediction regions, we considered 7 settings with various values of p, in each
of the settings. Recall that p, is the number of components for which two-sided intervals are
required. Table 4.8 shows the resulting estimated coverage probabilities for the proposed procedure

to compute mixed prediction regions.

coverage probability

. n = 30 | n=50 | n=100 | n= 120
p=3,q=2,p,=2 0.9406 | 0.9408 | 0.9472 | 0.9494
p=3,q¢=4,p: =1 0.9266 | 0.9326 | 0.9382 | 0.9426
p=3,q=4,p;=2 0.9402 | 0.9426 | 0.9438 | 0.9426
p=4,q=3,p; =2 0.9370 | 0.9404 | 0.9448 | 0.9468
p=4,¢=3,p,=3 0.9452 | 0.9462 | 0.9476 | 0.9492
p=4,q¢=3,p, =1 0.9196 | 0.9292 | 0.9352 | 0.9410
p=4,q=4,p1 =3 0.9468 | 0.9390 | 0.9416 | 0.9418

Table 4.8: Estimated coverage probabilities of the parametric bootstrap mixed prediction regions under multivariate normality for a 95% nominal
level.

The coverage probabilities are generally close to the nominal value of 0.95. However, when
p; = 1, the coverage probabilities may be liberal if the sample sizes are small. It seems that for
these settings a large sample size is necessary to estimate the prediction factors accurately. We

need a minimum sample size of 120 in order to attain accurate coverage.

We also compute the expected prediction factors for the mixed prediction regions. Recall that
km is the factor used in computing the two-sided intervals, and k,,2 is the factor used in computing
the one-sided intervals. Table 4.9 displays the expected prediction factors. We can see that the ex-
pected value of k,,; is larger compared to that of k2. In general, as the sample size increases, the
expected values of both k,,; and kj,2 decrease. Moreover, when the dimensions p and q increase,
the expected values of km; and km2 also increase. These results are consistent with the behavior of

the expected prediction factors in both the two-sided and one-sided prediction regions seen earlier.


mean prediction factor

n = 30 n= 50 n= 100 n = 120

p=3,q=2,p)=2 2.5490 2.2970 | 2.4574 2.1972 | 2.3996 2.1340 | 2.3902 2.1237
p=3,q9=4,p1 =1 2.5083 2.2527 | 2.4268 2.1638 | 2.3862 2.1154 | 2.3728 2.1046
p=3,qg=4,p,=2 2.6478 2.4018 | 2.5028 2.2467 | 2.4202 2.1565 | 2.4034 2.1381
p=4,q¢=3,pi=2 2.6518 2.4085 | 2.5507 2.2989 | 2.4884 2.2311 | 2.4797 1.2216
p=4,q=3,p,=3 2.7382 2.5016 | 2.5979 2.3501 | 2.5126 2.2575 | 2.4987 2.2423
p=4,q¢=4,p1=1 2.5714 2.3213 | 2.5032 2.2473 | 2.4631 2.2035 | 2.4580 2.1979
p=4,¢=4,p1=3 2.7937 2.5612 | 2.6269 2.3815 | 2.5239 2.2697 | 2.5098 2.2544

Table 4.9: Expected values of the parametric bootstrap mixed prediction region factors under multivariate normality for a 95% nominal level.

4.5 Comparing the Random- and Fixed-Covariate Methodolo-
gies

An important question to ask is what would happen if a methodology that assumes fixed co-
variates is applied to data in which the covariates are truly random. To answer this question, this
section compares the results of applying a fixed-covariate methodology with the proposed random-
covariate methodology, when the data are generated under the assumption of random covariates
(i.e., the model (3.7) holds). Lucagbo et al. (2021) propose a solution to compute rectangular pre-
diction regions that account for fixed covariates. Algorithm 4 describes the procedure of Lucagbo
et al. (2021), slightly modified for consistency with the notations and definitions in the present

study. We compare the estimated coverage probabilities, expected prediction factors, and volumes

of the proposed methodology with that obtained from Algorithm 4.


Algorithm 4 Rectangular prediction region for multivariate normal distribution in a regression
setting with fixed covariates.

. 1 1 1
1. Let Y = [Y,, Yo, .... Yn] be the p x n data matrix and X = lx, X, .. x,| be

the (q + 1) x n matrix of covariates. Suppose two-sided prediction limits are required
for a response vector Yo corresponding to the vector of covariates ©o.

2. Compute Band x using (3.9) and (3.11), respectively.

3. For b = 1,.

i. Generate vec -(B;) ~ Noiq+1) (vee (8), (XX')@ é),
DH ~W(n- (q+) 53), and You ~M (Bao, 5).
ii. Compute

n- at)

4. Compute the (1 — a)-quantile of ki sic, .-.,kp,sics Call this k. So that the 100(1 — a)%
rectangular prediction region for Y 9 is given by

|(B20),,=* Ean] ox |(Ba0) #8 En] .


We still use the settings described in Section 4.1. Moreover, we add three more settings, de-

scribed in the table below.

A comparison of the coverage probabilities for the random and fixed methodologies is pre-
sented in Table 4.10. The random-covariate methodology (Algorithm 1) produces accurate cov-
erage probabilities, as we have already seen. All of the coverage probabilities under the random-
covariate methodology are close to 0.95. On the other hand, the fixed-covariate methodology
displays robust performance in that most of the coverage probabilities are close to 0.95, even if the
underlying data assumption was not met. However, Table 4.10 also shows that the fixed-covariate
methodology can be outperformed by the random-covariate methodology when the sample size is
small (n = 30). The results for the settings (p = 3,q = 4), (p = 3,q = 7), and (p = 7,q = 5)

show low coverage probabilities for the fixed-covariate methodology.


coverage probability

n= 30 n= 50 n = 100 n= 120
Random Fixed | Random Fixed | Random’ Fixed | Random = Fixed
p=2,q=2 0.9536 0.9482] 0.9490 0.9486 | 0.9482 0.9452} 0.9538 0.9478

p=2,¢=3 0.9506 0.9450 | 0.9406 0.9438] 0.9500 0.9500} 0.9456 0.9520
p=2,q=4 0.9508 0.9446 | 0.9486 0.9440] 0.9502 0.9464] 0.9464 0.9512
p=3,q=2 0.9454 0.9462 | 0.9430 0.9438 | 0.9472 0.9474] 0.9492 0.9410
p=3,qg=3 0.9501 0.9466 | 0.9472 0.9486 | 0.9472 0.9510} 0.9492 0.9510
p=3,q=4 0.9448 0.9348 | 0.9458 0.9502 | 0.9444 0.9534 | 0.9478 0.9480
p=3,q=7 0.9490 0.9364 | 0.9518 0.9430] 0.9466 0.9520] 0.9490 0.9440
p=4,q¢q=3 0.9440 0.9458 | 0.9482 0.9424] 0.9458 0.9454 | 0.9498 0.9494
p=4,q=4 0.9448 0.9470} 0.9504 0.9442 | 0.9524 0.9530} 0.9490 0.9484
p=7,q=5 0.9540 0.9398 | 0.9530 0.9420] 0.9472 0.9486) 0.9498 0.9442
p=8,q=3 0.9460 0.9456 | 0.9496 0.9508 | 0.9474 0.9508} 0.9480 0.9510

Table 4.10: Comparison of the estimated coverage probabilities under the random- and fixed-covariate procedures to compute parametric bootstrap
(two-sided prediction regions under multivariate normality for a 95% nominal level.

Tables 4.11 and 4.12 compare the expected prediction factors and expected volumes, respec-
tively, of the two procedures. We can see that the expected prediction factors and expected vol-
umes under the fixed-covariate procedure are always slightly less than that of the random-covariate
procedure. The difference shrinks, however, as the sample size increases. The smaller expected
prediction factors and volumes for the fixed-covariate methodology are consistent with its tendency

to result in low coverage for some settings.

The small expected volume of the fixed-covariate methodology can result in false-positive de-
tections. In other words, some patients who do not have the disease or medical condition will be
misclassified as having it. This is particularly undesirable in diagnostic or confirmatory tests where

the goal is to “rule in” a diagnosis suggested by other tests.

35,

mean prediction factor
n=30 |  n=50 n = 100 n = 120
Random Fixed | Random Fixed | Random Fixed | Random Fixed
p=2,qg=2 2.4599 2.4476| 2.3471 2.3421 | 2.2715 2.2744] 2.2631 2.2617

p=2,qg=3 2.5171 2.4916] 2.3762 2.3659 |} 2.2867 2.2834} 2.2714 2.2710
p=2,q=4 2.5721 2.5362) 2.4031 2.3918 | 2.2977 2.2952 | 2.2805 2.2759
p=3,qg=2 2.6298 2.6142] 2.5035 2.4991] 2.4183 2.4181 | 2.4059 2.4056
p=3,q=3 2.6894 2.6638 | 2.5307 2.5256) 2.4320 2.4297) 2.4165 2.4135
p=3,q=4 2.7546 2.7078 | 2.5641 2.5505 | 2.4455 2.4416 | 2.4277 2.4244
p=3,q=7 2.9808 2.8563 | 2.6656 2.6274 | 2.4863 2.4770} 2.4606 2.4534
p=4,q=3 2.8099 2.7832] 2.6393 2.6304] 2.5312 2.5269} 2.5130 2.5109
p=4,q=4 2.8778 2.8344) 2.6739 2.6589 | 2.5430 2.5392 | 2.5242 2.5224
p=7,q¢q=5 3.1923 3.1164] 2.9126 2.8904 | 2.7462 2.7408} 2.7199 2.7163
p=8,q=3 3.0861 3.0557 | 2.8837 2.8745 | 2.7563 2.7543 | 2.7371 2.7373

Table 4.11: Comparison of the expected prediction factors under the fixed- and random-covariate procedures to compute parametric bootstrap two-
sided prediction regions under multivariate normality for a 95% nominal level.


Le

mean volume

n= 30_ al n= 50

Random Fixed Random Fixed
p=2,q=2 23.8545 23.6669 | 21.8533 21.8032
p=2,q=3 24.9617 24.5007 | 22.3519 22.2135
p=2,qg=4 26.0852 25.2200 | 22.9311 22.7124
p=3,q=2 143.446 140.949 | 124.352 123.911
p=3,q=3 154.038 149.011 128.769 128.294
p=3,q=4 165.210 156.649 | 133.535 132.358
p=3,q=7 208.368 183.171 | 149.457 143.464
p=4,q=3 985.045 947.888 | 772.191 766.356
p=4,¢=4 1084.10 1017.04 | 814.405 799.603
P=7,¢=5 448,450.3 372,386 | 230,124.2 221,757.5
p=8,q=3 2,208,686 2,002,956 | 1.276549 1,239,070

L n = 120
Random Fixed
20.3994 20.4107

20.6368 = 20.6378
20.9206 20.8284 | 20.5785 20.5964
21.0792 20.9788 | 20.7518 20.6997
113.426 = 113.182 | 111.157 111.046
115.044 114.593 | 112.809 112.761
116.551 115.744 | 114.239 114.096
122.366 121.468 | 119.056 117.626
656.260 653.127 | 638.914 638.338
668.464 667.404 | 650.754 647.246

152,703.7 152,295.7 | 144,562.4  141,874.1

871,259.9 870,604.7 | 825,610.4 829,217.1

‘Table 4.12: Comparison of the expected volumes under the fixed- and random-covariale procedures (o compute parametric bootstrap two-sided prediction regions under multivariate normality for a 95%
nominal level.

4.6 Real-life Data Application: Insulin-like Growth Factors

We now apply our proposed methodology to compute rectangular reference regions using data
from Mattsson et al. (2008). The application seeks to compute a reference region for the three com-
ponents of the insulin-like growth factor system in adults: the serum concentrations of insulin-like
growth factor I (S-IGF-I), insulin-like growth factor-binding protein 2 (S-IGFBP-2) and insulin-
like growth factor-binding protein 3 (S-IGFBP-3). The said variables are in the units pg/L. The
covariates that we include in the multivariate regression model are age, sex, and body mass index

(BMI).
The covariate vectors are of the following form:

(1, age — 45, (age — 45)”, sex, BMI — 25)’ ; (4.1)

where sex is coded as 0 for males and 1 for females. Moreover, the response vector is based on the

transformed values of the serum measurements:

(In (S-IGF-I), (S-IGFBP-2)”, In (S-IGFBP-3))’. (4.2)

There are n = 427 subjects in the study, of whom 310 are men and 117 are women.

The least squares estimates of B and ¥ are given by


4.85433 —0.01437 0.00019  -—0.03486 —0.00221
B= |4.44923 0.00977 —0.00010 —0.04277 —0.06545 (4.3)
8.07157 —0.00434 -—0.00004 0.08677 0.00325

0.06982  -—0.01365 0.03117

>
ll

—0.01365 0.20727 —0.01687] - (4.4)
0.03117 —0.01687 0.04098

After applying the procedure in Algorithm 1 using the said covariates in (4.1), we get rectangu-
lar reference regions whose patterns are displayed in Figures 4.1 and 4.2. In Figure 4.1, resulting
pairwise plots are displayed for healthy 20-year-old males by BMI, where BMI ranges from 15
kg/m? to 40 kg/m?. The reference ranges for both S-IGF-I and S-IGFBP-2 decrease when BMI
is increasing. In Figure 4.2, resulting pairwise plots are displayed for healthy females, with BMI
equal to 30 kg/m?, by age. Age ranges from 20 years to 70 years. As we can see, the reference
ranges for S-IGF-I and S-IGFBP-3 decrease when age is increasing. In contrast, the ranges for
S-IGFBP-2 are increasing when age is also increasing. These illustrations indicate the importance
of using covariate-specific reference regions since no unique set of ranges applies to all people

regardless of age and BMI.



o
a 8 a 8
irq 2 °
oO (U}
6 8 d
wo o
c=]
Rg
oOo °o
0 100 200 300 400 500 0 500 1000 1500 2000
SAGF4 SAGFBP.2


SAGFBP-3

0 2000

0 100 200 300 400 500

SAGF-

Figure 4.1: Pairwise plots of reference region using 95% rectangular predictions in a multivariate normal setting with covariates. The reference
regions are for healthy 20-year-old males by BMI.



S
a 2 DE
® g ®
3 8 3
0 °
So
ao
N
oOo oO
() 100 200 300 400 500 0 500 1000 1500
S-IGF-4 SAGFBP-2

SIGFBP-3
6000 10000

0 2000

0 100 200 300 400 500

SIGF4

Figure 4.2: Pairwise plots of reference region using 95% rectangular predictions in a multivariate normal setting with covariates. The reference
regions are for healthy females by age, with BMI of 30 kg/m?.


Chapter 5

Discussion

Reference intervals are indispensable in the laboratory medicine literature. They have to be
constructed using sound statistical criteria. For complicated types of diagnoses, such as those of
kidney function and liver function, it may not be enough to base conclusions on a single mea-
surement. Kidney function is assessed based on measurements on a patient’s urea, uric acid, and
creatinine levels. Liver function is assessed through measurements taken on alanine transaminase
(ALT) and aspartate transaminase (AST). These analytes are correlated, and thus the use of sepa-
rate univariate reference intervals is inappropriate. A methodology to compute a reference region

that accounts for the correlation among measurements is needed.

To address this need, many studies have proposed methods to compute multivariate reference
regions. Unfortunately, in spite of the availability of methods to compute multivariate reference
regions, such regions have not been used widely in actual practice. As Harris and Boyd (1995)
mention, these regions have largely remained “a statistical curiosity to the great majority of clin-
ical chemists and clinicians and have little or no use in present-day clinical practice.’ Writing
more recently, Wellek (2011) echoes the same sentiment: “Till now, multivariate reference regions
have played only a marginal role in the practice of clinical chemistry and laboratory medicine.”

Furthermore, Wellek observes that the less than prominent role that multivariate reference regions


have played is because they are constructed as ellipsoidal regions, which by design cannot detect
the outlyingness of specific components of a test profile. This calls for rectangular regions, which
have the capacity to detect outlying components. Consequently, Wellek (2011), Young and Mathew
(2020), and Lucagbo et al. (2021) have each developed rectangular reference regions under various
settings and using different criteria. Since the reference ranges may depend on covariates, Young
and Mathew (2020) and Lucagbo et al. (2021) propose extensions to incorporate information from

fixed covariates.

This study puts forward a solution to construct rectangular multivariate reference regions that
account for random covariates. Under such model, it seems intuitive to let the region of the form
(Bo + B, Xo) +k Dus) fori = 1,...,p. However, it is not clear how to adjust k so that the
correlations among the p components are properly accounted for. The results indicate that this
study succeeds in finding a suitable bootstrap to estimate this prediction factor for different cases.

The results show accurate coverage that is robust to both the sample size and the dimension.

A multivariate normal distribution for the measurements is assumed in this study, which is a
standard assumption in computing reference intervals in the clinical laboratory literature. In actual
practice, medical data can yield skewed values that clearly deviate from the normal distribution.
To address this, appropriate transformations for normality have been adopted in the laboratory

medicine literature for measurements that are skewed in nature.

Existing studies about constructing rectangular reference regions in the presence of covariates
assume that the covariates are fixed. This assumption fails in most reference interval determination
studies where researchers typically do not control the values of covariates. In this study, we have
shown that the fixed-covariate methodology is robust to the assumption of non-randomness. That
is, even if the covariates are in fact random, the fixed-covariate methodology can still perform well

in a reasonably wide variety of parameter settings.


Nonetheless, the results also show that the fixed-covariate method can sometimes produce
small reference regions, resulting in liberal coverage probabilities and thus false-positive mis-
classifications of patients. Such being the case, there is a need to develop a theoretically sound
methodology that already accounts for the random-covariate nature of the data. We believe that

this study is the first attempt to propose such methodology.

Bibliography

1. Albert, A. and Harris, E. (1987). Multivariate interpretation of clinical laboratory data,

volume 75. Marcel Dekker, Inc.

2. Albert, A. and Heusghem, C. (1981). Relating observed values to reference values: the
multivariate approach. Reference values in laboratory medicine. Chichester, New York,

Brisbane, Toronto, Singapore: John Wiley & Sons, pages 289-96.

3.  Bharali, S. and Hazarika, J. (2018). Regression models with stochastic regressors: An

expository note.

4. Boyd, J. C. and Lacher, D. A. (1982). The multivariate reference range: an alternative

interpretation of multi-test profiles. Clinical chemistry, 28(2):259-265.

5.  CLSI, D. (2008). establishing, and verifying reference intervals in the clinical laboratory;
approved guideline—. C28-A3, Wayne PA, Clinical and Laboratory Standards Institute.

6. Dong, X. and Mathew, T. (2015). Central tolerance regions and reference regions for mul-

tivariate normal populations. Journal of Multivariate Analysis, 134:50-60.

7. Grasbeck, R. (1969). Establishment and use of normal values. Scand J Clin Invest, 110:1-
15.

8. Harris, E. (1981). Statistical aspects of reference values in clinical pathology. Progress in

clinical pathology, 8:45—-66.


10.

15.

16.

17.

Harris, E. K. and Boyd, J. C. (1995). Statistical bases of reference values in laboratory
medicine. CRC Press.

Horn, P. S. and Pesce, A. J. (2005). Reference intervals: a user’s guide. American Associ-

ation for Clinical Chemistry, Incorporated.

Ichihara, K., Ozarda, Y., Klee, G., Straseski, J, Baumann, N., and Ishikura, K. (2013).
Utility of a panel of sera for the alignment of test results in the worldwide multicenter

study on reference values. Clinical chemistry and laboratory medicine, 51(5):1007—1025.

Lee, G. R., Griffin, A., Halton, K., and Fitzgibbon, M. C. (2017). Generating method-

specific reference ranges—a harmonious outcome? Practical laboratory medicine, 9:1-11.

Liu, W., Bretz, F., and Cortina-Borja, M. (2021). Reference range: Which statistical inter-

vals to use? Statistical Methods in Medical Research, 30(2):523-534.

Lucagbo, M., Mathew, T., and Young, D. (2021). Rectangular multivariate normal predic-

tion regions for setting reference regions in laboratory medicine. submitted.

Mattsson, A., Svensson, D., Schuett, B., Osterziel, K. J., and Ranke, M. B. (2008). Mul-
tidimensional reference regions for igf-i, igfbp-2 and igfbp-3 concentrations in serum of

healthy adults. Growth Hormone & IGF Research, 18(6):506-516.

Odhiambo, C., Oyaro, B., Odipo, R., Otieno, F., Alemnji, G., Williamson, J., and Zeh, C.
(2015). Evaluation of locally established reference intervals for hematology and biochem-

istry parameters in western kenya. Plos one, 10(4):e0123140.

Ozarda, Y., Ichihara, K., Barth, J., and Klee, G. (2013). Committee on reference inter-
vals and decision limits (c-ridl), international federation for clinical chemistry and labora-
tory medicine. protocol and standard operating procedures for common use in a worldwide

multicenter study on reference values. Clin Chem Lab Med, 51(5):1027—1040.


18.

20.

21.

22.

23.

24.

25.

Patal, P., Hamin, J., Bautista, A., Jimeno, C., Acampado, L., Hipolito, M., Gomez, I., An-
tonio, M., Domingo, E., and Lim-Abrahan, M. A. (2016). Trimester-specific reference
interval for thyroid function tests in pregnant filipino women. Journal of the ASEAN Fed-

eration of Endocrine Societies, 31(1):18-18.

Ripley, B., Venables, B., Bates, D. M., Hornik, K., Gebhardt, A., Firth, D., and Ripley,
M. B. (2013). Package ‘mass’. Cran r, 538:113-120.

Solberg, H. (1987). International federation of clinical chemistry (ifcc), scientific com-
mittee, clinical section, expert panel on theory of reference values, and international com-
mittee for standardization in haematology (icsh), standing committee on reference values.
approved recommendation (1986) on the theory of reference values. part 1. the concept of
reference values. Journal of clinical chemistry and clinical biochemistry. Zeitschrift fur

klinische Chemie und klinische Biochemie, 25(5):337-342.
Strike, P. W. (2014). Statistical methods in laboratory medicine. Butterworth-Heinemann.

Wellek, S. (2011). On easily interpretable multivariate reference regions of rectangular

shape. Biometrical journal, 53(3):491-511.

Winkel, P., Gaede, P., and Lyngbye, J. (1976). Method for monitoring plasma progesterone

concentrations in pregnancy. Clinical chemistry, 22(4):422-428.

Young, D. S. and Mathew, T. (2020). Nonparametric hyperrectangular tolerance and pre-
diction regions for setting multivariate reference regions in laboratory medicine. Statistical

Methods in Medical Research, 29(12):3569-3585.

Zimmerman, H. J. (1999). Hepatotoxicity: the adverse effects of drugs and other chemicals

on the liver.
